<h1>About</h1>
<p><span>åŸ·è¡Œä¸‰å€‹ç¨‹å¼çš„å½±ç‰‡é€£çµï¼š<a href="https://youtu.be/PZbXoRjJsRk?si=1T8Jf0veygwvqIgG">https://youtu.be/PZbXoRjJsRk?si=1T8Jf0veygwvqIgG</a></span></p>
<p><span>å¿ƒå¾—ï¼š</span></p>
<p data-path-to-node="9,0">åœ¨åŸ·è¡Œé€™ç³»åˆ—ç¨‹å¼çš„éç¨‹ä¸­ï¼Œæˆ‘é‹ç”¨äº†å¯æ”œå¼ç¨‹å¼å¥—ä»¶é€²è¡Œå¯¦ä½œï¼Œä¸¦é€éæ“ä½œçµ‚ç«¯æ©Ÿèˆ‡é›»è…¦å°è©±ã€‚é€™æ®µç¶“æ­·è®“æˆ‘èƒ½å³æ™‚è§€å¯ŸæŒ‡ä»¤åŸ·è¡Œçš„åé¥‹ï¼Œä¸¦åœ¨é‡åˆ°éŒ¯èª¤æ™‚åè¦†ä¿®æ­£ï¼Œé€²è€Œæ·±å…¥ç†è§£ç¶²é ç¨‹å¼çš„é‹è¡Œé‚è¼¯ã€‚</p>
<p data-path-to-node="9,1"><b data-index-in-node="0" data-path-to-node="9,1">1. å¾Œç«¯æ¶æ§‹ç†è§£ï¼šFlask å¼•æ“èˆ‡é€šè¨ŠåŸ ç®¡ç†</b>Â ï¼šé€éåœ¨çµ‚ç«¯æ©ŸåŸ·è¡Œ<span>Â </span><code data-index-in-node="34" data-path-to-node="9,1">pip install flask peewee flask_bcrypt</code>ï¼Œæˆ‘æˆåŠŸå®‰è£äº†å°ˆæ¡ˆæ‰€éœ€çš„å¾Œç«¯æ¨¡çµ„ã€‚æˆ‘èªè­˜åˆ°<span>Â </span><b data-index-in-node="93" data-path-to-node="9,1">Flask</b><span>Â </span>æ‰®æ¼”è‘—ã€Œå¾Œç«¯å¼•æ“ã€çš„è§’è‰²ï¼Œè² è²¬è™•ç†æ•¸æ“šä¸¦æ¶è¨­ä¼ºæœå™¨ç’°å¢ƒã€‚åœ¨åŸ·è¡Œç¬¬äºŒå€‹ç¨‹å¼æ™‚ï¼Œæˆ‘é‡åˆ°äº†<b data-index-in-node="141" data-path-to-node="9,1">é€šè¨ŠåŸ è¡çª</b>çš„æŒ‘æˆ°ï¼Œå› ç‚ºç¬¬ä¸€å€‹ç¨‹å¼å·²ä½”ç”¨äº†é è¨­çš„<span>Â </span><code data-index-in-node="171" data-path-to-node="9,1">port 5000</code>ï¼Œæ‰€ä»¥æˆ‘å¿…é ˆä¿®æ”¹<span>Â </span><code data-index-in-node="189" data-path-to-node="9,1">app.py</code><span>Â </span>æœ€å¾Œä¸€è¡Œï¼Œæ‰‹å‹•æŒ‡å®šç‚º<span>Â </span><code data-index-in-node="207" data-path-to-node="9,1">port=5001</code><span>Â </span>æ‰èƒ½è®“ç¨‹å¼é †åˆ©å•Ÿå‹•ã€‚</p>
<p data-path-to-node="9,2"><b data-index-in-node="0" data-path-to-node="9,2">2. å°ˆæ¡ˆéƒ¨ç½²èˆ‡ç›®éŒ„åˆ‡æ›å¯¦å‹™</b>Â ï¼šåˆ°äº†ç¬¬ä¸‰å€‹ã€Œæ†¤æ€’é³¥èˆ‡å°è±¬ã€éŠæˆ²å°ˆæ¡ˆï¼Œæˆ‘å·²èƒ½ç†Ÿç·´åœ°åœ¨çµ‚ç«¯æ©Ÿä¸­å®Œæˆå¥—ä»¶å®‰è£èˆ‡ç›®éŒ„åˆ‡æ›ã€‚æˆ‘ç†è§£åˆ°åœ¨åŸ·è¡Œä¸åŒå°ˆæ¡ˆæ™‚ï¼Œå¿…é ˆä½¿ç”¨<span>Â </span><b data-index-in-node="74" data-path-to-node="9,2"><code data-index-in-node="74" data-path-to-node="9,2">cd</code></b><span>Â </span>æŒ‡ä»¤ç²¾æº–æ§åˆ¶è·¯å¾‘ï¼šæ¯ç•¶å®Œæˆä¸€å€‹ç¨‹å¼ä¸¦æŒ‰ä¸‹<span>Â </span><code data-index-in-node="98" data-path-to-node="9,2">Ctrl+C</code><span>Â </span>çµæŸå¾Œï¼Œæˆ‘æœƒå…ˆè¼¸å…¥<span>Â </span><b data-index-in-node="115" data-path-to-node="9,2"><code data-index-in-node="115" data-path-to-node="9,2">cd ..</code></b><span>Â </span>å›åˆ°ä¸Šä¸€å±¤ç›®éŒ„ï¼Œå†é€²å…¥ä¸‹ä¸€å€‹å°ˆæ¡ˆè³‡æ–™å¤¾å•Ÿå‹•æ–°æœå‹™ã€‚</p>
<p data-path-to-node="9,3">é›–ç„¶ä¸€é–‹å§‹å°æ“ä½œæµç¨‹æ„Ÿåˆ°é™Œç”Ÿï¼Œä¸”å¸¸å› æŒ‡ä»¤è¼¸å…¥éŒ¯èª¤æˆ–è·¯å¾‘ä¸å°å°è‡´ç¨‹å¼ç„¡æ³•åŸ·è¡Œï¼Œä½†é€éä¸æ–·å˜—è©¦ã€åœ¨çµ‚ç«¯æ©Ÿä¸­åˆ†æéŒ¯èª¤ï¼Œä»¥åŠå‘è€å¸«èˆ‡åŒå­¸è«‹æ•™ï¼Œæˆ‘é€æ¼¸ç†è§£äº†æ¯å€‹æ­¥é©ŸèƒŒå¾Œçš„æŠ€è¡“å«ç¾©ã€‚</p>
<p>èª²ç¨‹åç¨±: è¨ˆç®—æ©Ÿç¨‹å¼</p>
<p>èª²ç¨‹è©•åˆ†:</p>
<p style="padding-left: 30px;"><span style="background-color: #ffff00;">å­¸ç¿’å¿ƒå¾—å ±å‘Š (60%)</span> - MS Teams ç·šä¸Šåƒèˆ‡ï¼Œ<span style="background-color: #ccffcc;">6äººä¸€çµ„</span>æ¯ä¸‰é€±ç™¼è¡¨å­¸ç¿’å¿ƒå¾—ã€‚</p>
<p style="padding-left: 60px;">w3ã€w7ã€w10ã€w14ã€w17ã€w18</p>
<p style="padding-left: 60px;">å­¸ç¿’å¿ƒå¾—å ±å‘Šä¸»é¡Œ:</p>
<p style="padding-left: 60px;">w3: ä»€éº¼æ˜¯ git, GitHub, gist èˆ‡ cmsimde? å¦‚ä½•ä½¿ç”¨é€™äº›å·¥å…·ï¼Ÿç‚ºä»€éº¼è¦ä½¿ç”¨é€™äº›å·¥å…·ï¼Ÿ (<a href="https://mde.tw/cp2025/content/Brython.html?src=https://gist.githubusercontent.com/mdecycu/71ff1c69dd233e6a5a83dd60997950de/raw/b4134dc3724f9c6aa1de7534a74f298288de0fa5/round_dot_move.py">å‹•æ…‹æ¨¡æ“¬</a>)</p>
<p style="padding-left: 60px;">w7: Brython æ˜¯ä»€éº¼ï¼Ÿå¦‚ä½•åœ¨ç€è¦½å™¨é…ç½® Brython ç’°å¢ƒï¼Ÿ Brython èƒ½åšä»€éº¼ï¼Ÿ (<a href="https://mde.tw/cp2025/content/Brython.html">Brython</a>, <a href="https://mde.tw/cp2025/content/Robot_ex.html">Examples</a>)</p>
<p style="padding-left: 60px;">w10: å¦‚ä½•åœ¨ç€è¦½å™¨ä¸­æ¨¡æ“¬æ©Ÿå™¨äººä½œå‹•ï¼Ÿ (<a href="https://mde.tw/cp2025/content/Brython.html?src=https://gist.githubusercontent.com/mdecycu/58fed8bd2f5be98a6456a8dcae512011/raw/4019adba4ee4be19c35982d835bad8e7d83a7b2f/brython_robot4_ex1.py">æ©Ÿå™¨äººä½œå‹•</a>)</p>
<p style="padding-left: 60px;">w14: åœ¨ç€è¦½å™¨ä¸­æ¨¡æ“¬æ©Ÿå™¨äººä½œå‹•çš„ç›®çš„æ˜¯ä»€éº¼ï¼Ÿ (<a href="/downloads/otto_robot.7z">otto_robot.7z</a>,Â <a href="https://mde.tw/cad2025/content/Homework.html">Plotter</a>,Â <a href="/downloads/open_duck_mini.7z">open_duck_mini.7z</a> ,<a href="https://webots.cloud/AcTNYs0">https://webots.cloud/AcTNYs0</a>)</p>
<p style="padding-left: 60px;">w17 (<span style="background-color: #ccffcc;">1b æ¡ Youtube å½±ç‰‡ç°¡å ±</span>): è¨ˆç®—æ©Ÿç¨‹å¼èª²ç¨‹å­¸åˆ°äº†ä»€éº¼ï¼Ÿ</p>
<p style="padding-left: 60px;">w18: èª²ç¨‹ç¸½çµ</p>
<p style="padding-left: 30px;"><span style="background-color: #ffff00;">å€‹äººèˆ‡åˆ†çµ„ç¶²ç«™ç¶­è­· (40%)</span> - æ¯é€±è‡³å°‘å…©æ¬¡æ¨é€èˆ‡èª²ç¨‹é€²åº¦ç›¸é—œçš„å­¸ç¿’å…§å®¹èˆ‡å¿ƒå¾—ã€‚</p>
<p style="padding-left: 60px;">w9 æœŸä¸­è‡ªè©•ã€w18 æœŸæœ«è‡ªè©•</p><h1>é»æ“Šçƒ</h1>
<p>é™„åŠ çš„æ–°åŠŸèƒ½ï¼š</p>
<p>1.å‘¼å¸æ„Ÿå‹•ç•«æ•ˆæœï¼šçƒé«”æœƒè¦å¾‹çš„é€²è¡Œã€Œç¸®æ”¾ã€å¾‹å‹•</p>
<p>2.é»æ“Šè¦–è¦ºå›é¥‹ï¼šæ³¢ç´‹ç‰¹æ•ˆã€æµ®å‹•åˆ†æ•¸</p>
<p>3.å‹•æ…‹è®Šè‰²ï¼šæ“Šä¸­çƒå¾Œï¼Œæœƒå¾é¡è‰²æ¸…å–®ä¸­éš¨æ©Ÿæ›´æ›é¡è‰²</p>
<script src="/static/brython.js"></script>
<script src="/static/brython_stdlib.js"></script>
<script>
window.onload = function(){
  brython({debug:1, pythonpath:['/static/']});
}
</script>
<div id="brython_div1"></div>
<script type="text/python3">
from browser import document, timer
import random, time

# ===== éŠæˆ²è¨­å®š =====
GAME_DURATION = 40
BALL_SIZE = 50

# ===== ç‹€æ…‹ =====
score = 0
game_active = False
ball_handle = None
time_handle = None

# ===== é¡è‰² =====
colors = ["red", "blue", "green", "orange", "purple"]
current_color = "blue"

# ===== éŠæˆ²å€ =====
game_area = document["brython_div1"]
game_area.style.width = "600px"
game_area.style.height = "500px"
game_area.style.margin = "20px auto"
game_area.style.border = "3px solid #333"
game_area.style.backgroundColor = "#e0e0ff"
game_area.style.position = "relative"
game_area.style.overflow = "hidden"
game_area.style.cursor = "crosshair"

# ===== CSS ç‰¹æ•ˆ (æ–°å¢äº† ballPulse å‹•ç•«) =====
style = document.createElement("style")
style.text = """
@keyframes ballPulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.15); }
  100% { transform: scale(1); }
}
.pulsing-ball {
  animation: ballPulse 0.8s infinite ease-in-out;
}
@keyframes ripple {
  from { transform: scale(0.5); opacity: 0.8; }
  to   { transform: scale(2.5); opacity: 0; }
}
@keyframes floatScore {
  from { transform: translateY(0); opacity: 1; }
  to   { transform: translateY(-40px); opacity: 0; }
}
.ripple {
  position: absolute;
  border: 3px solid white;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: ripple 0.5s ease-out;
  pointer-events: none;
}
.float-score {
  position: absolute;
  font-size: 22px;
  font-weight: bold;
  color: red;
  animation: floatScore 0.6s ease-out;
  pointer-events: none;
}
"""
document <= style

# ===== åˆ†æ•¸ =====
score_display = document.createElement("div")
score_display.style.position = "absolute"
score_display.style.top = "10px"
score_display.style.left = "10px"
score_display.style.fontSize = "1.2em"
score_display.style.fontWeight = "bold"
score_display.style.backgroundColor = "rgba(255,255,255,0.7)"
score_display.style.padding = "5px"
game_area <= score_display

# ===== æ™‚é–“ =====
timer_display = document.createElement("div")
timer_display.style.position = "absolute"
timer_display.style.top = "10px"
timer_display.style.right = "10px"
timer_display.style.fontSize = "1.2em"
timer_display.style.fontWeight = "bold"
timer_display.style.backgroundColor = "rgba(255,255,255,0.7)"
timer_display.style.padding = "5px"
game_area <= timer_display

# ===== çƒ (åŠ ä¸Šäº† pulsing-ball é¡åˆ¥) =====
ball = document.createElement("div")
ball.classList.add("pulsing-ball") # å•Ÿå‹•å‘¼å¸æ•ˆæœ
ball.style.width = f"{BALL_SIZE}px"
ball.style.height = f"{BALL_SIZE}px"
ball.style.borderRadius = "50%"
ball.style.position = "absolute"
ball.style.cursor = "pointer"
ball.style.transition = "top 0.5s, left 0.5s"
ball.style.backgroundColor = current_color
game_area <= ball

# ===== æ³¢ç´‹ =====
def show_ripple(x, y):
    r = document.createElement("div")
    r.className = "ripple"
    r.style.left = f"{x}px"
    r.style.top = f"{y}px"
    game_area <= r
    timer.set_timeout(lambda: r.remove(), 500)

# ===== +1 æµ®å‡º =====
def show_plus_one(x, y):
    fs = document.createElement("div")
    fs.className = "float-score"
    fs.text = "+1"
    fs.style.left = f"{x + 15}px"
    fs.style.top = f"{y}px"
    game_area <= fs
    timer.set_timeout(lambda: fs.remove(), 600)

# ===== çƒç§»å‹• =====
def move_ball():
    if not game_active:
        return
    max_x = game_area.clientWidth - BALL_SIZE
    max_y = game_area.clientHeight - BALL_SIZE
    ball.style.left = f"{random.randint(0, max_x)}px"
    ball.style.top = f"{random.randint(40, max_y)}px"

# ===== é»æ“Šçƒ =====
def hit_ball(ev):
    global score, current_color
    if not game_active:
        return

    score += 1
    score_display.text = f"åˆ†æ•¸: {score}"

    x = ball.offsetLeft
    y = ball.offsetTop

    show_ripple(x, y)
    show_plus_one(x, y)

    current_color = random.choice(colors)
    ball.style.backgroundColor = current_color
    move_ball()
    ev.stopPropagation()

ball.bind("click", hit_ball)

# ===== çµæŸç•«é¢ =====
game_over = document.createElement("div")
game_over.style.position = "absolute"
game_over.style.top = "50%"
game_over.style.left = "50%"
game_over.style.transform = "translate(-50%, -50%)"
game_over.style.backgroundColor = "rgba(0,0,0,0.9)"
game_over.style.color = "white"
game_over.style.padding = "30px"
game_over.style.borderRadius = "10px"
game_over.style.fontSize = "2em"
game_over.style.display = "none"
game_over.style.textAlign = "center"
game_over.style.zIndex = "10"
game_area <= game_over

# ===== é‡æ–°é–‹å§‹ =====
def restart_game(ev=None):
    game_over.style.display = "none"
    start_game()

# ===== æ™‚é–“ =====
def check_time():
    global game_active
    remain = int(end_time - time.time())

    if remain <= 5 and remain > 0:
        timer_display.style.color = "red"
    else:
        timer_display.style.color = "black"

    if remain <= 0:
        timer_display.text = "æ™‚é–“: 0s"
        game_active = False
        game_over.innerHTML = f"éŠæˆ²çµæŸ<br>æœ€çµ‚åˆ†æ•¸: {score}<br>"
        btn = document.createElement("button")
        btn.text = "é‡æ–°é–‹å§‹"
        btn.style.fontSize = "0.6em"
        btn.style.marginTop = "15px"
        btn.bind("click", restart_game)
        game_over <= btn
        game_over.style.display = "block"
        timer.clear_interval(ball_handle)
        timer.clear_interval(time_handle)
    else:
        timer_display.text = f"æ™‚é–“: {remain}s"

# ===== é–‹å§‹ =====
def start_game():
    global score, game_active, end_time, ball_handle, time_handle
    score = 0
    game_active = True
    score_display.text = "åˆ†æ•¸: 0"
    timer_display.text = f"æ™‚é–“: {GAME_DURATION}s"
    timer_display.style.color = "black"
    end_time = time.time() + GAME_DURATION
    move_ball()
    ball_handle = timer.set_interval(move_ball, 1000)
    time_handle = timer.set_interval(check_time, 1000)

start_game()
</script><h1>Final</h1>
<p><span data-teams="true">41423102 - 2025 è¨ˆç®—æ©Ÿç¨‹å¼æœŸæœ«è€ƒé€±é¡Œç›®</span></p>
<p><span data-teams="true">YTé€£çµï¼š<a href="https://www.youtube.com/watch?v=lFz1hOQ8Wms">https://www.youtube.com/watch?v=lFz1hOQ8Wms</a></span></p><h1>ç§»å‹•æ–¹å¡ŠéŠæˆ²</h1>
<p>æ§åˆ¶æ–¹å¡Šï¼Œé¿é–‹ç§»å‹•çš„ç´…è‰²æ•µäººï¼Œç›¡å¯èƒ½é•·æ™‚é–“ç”Ÿå­˜ï¼Œç²å¾—æ›´é«˜çš„åˆ†æ•¸</p>
<!-- å°å…¥ brython ç¨‹å¼åº« -->
<p>
<script src="/static/brython.js"></script>
<script src="/static/brython_stdlib.js"></script>
</p>
<!-- å•Ÿå‹• Brython -->
<p>
<script>
window.onload=function(){
brython({debug:1, pythonpath:['/static/','./../downloads/py/']});
}
</script>
</p>
<p><!-- å°å…¥ FileSaver èˆ‡ filereader --></p>
<p>
<script src="/static/ace/FileSaver.min.js" type="text/javascript"></script>
<script src="/static/ace/filereader.js" type="text/javascript"></script>
</p>
<p><!-- å°å…¥ ace --></p>
<p>
<script src="/static/ace/ace.js" type="text/javascript"></script>
<script src="/static/ace/ext-language_tools.js" type="text/javascript"></script>
<script src="/static/ace/mode-python3.js" type="text/javascript"></script>
<script src="/static/ace/snippets/python.js" type="text/javascript"></script>
</p>
<p><!-- å°å…¥ gearUtils-0.9.js Cango é½’è¼ªç¹ªåœ–ç¨‹å¼åº« -->
<script src="/static/Cango-24v03-min.js"></script>
<script src="/static/gearUtils-09.js"></script>
<script src="/static/SVGpathUtils-6v03-min.js"></script>
<script src="/static/sylvester.js"></script>
<script src="/static/PrairieDraw.js"></script>
</p>
<p><!-- è«‹æ³¨æ„, é€™è£¡ä½¿ç”¨ Javascript å°‡ localStorage["kw_py_src1"] ä¸­å­˜åœ¨è¿‘ç«¯ç€è¦½å™¨çš„ç¨‹å¼ç¢¼, ç”±ä½¿ç”¨è€…æ±ºå®šå­˜æª”åç¨±--></p>
<p>
<script type="text/javascript">
function doSave(storage_id, filename){
    var blob = new Blob([localStorage[storage_id]], {type: "text/plain;charset=utf-8"});
    filename = document.getElementById(filename).value
    saveAs(blob, filename+".py");
}
</script>
</p>
<!-- æ§åˆ¶æŒ‰éˆ•å€ -->
<div style="margin: 10px;"><button id="btn_up">â†‘</button> <button id="btn_down">â†“</button> <button id="btn_left">â†</button> <button id="btn_right">â†’</button> <button id="btn_spawn">ç”Ÿæˆæ•µäºº</button> <button id="btn_color">æ”¹ç©å®¶é¡è‰²</button> <button id="btn_restart">é‡æ–°é–‹å§‹</button></div>
<!-- éŠæˆ²å€ -->
<div id="game_area" style="width: 400px; height: 400px; border: 2px solid black; position: relative; margin: 10px; overflow: hidden;"><!-- ç©å®¶æ–¹å¡Š -->
<div id="player" style="width: 40px; height: 40px; background: blue; position: absolute; left: 180px; /* width/2 - player_size/2 */        top: 180px;"></div>
</div>
<!-- åˆ†æ•¸å€ -->
<div id="score_display" style="margin: 5px; font-weight: bold;">åˆ†æ•¸: 0</div>
<!-- éŠæˆ²çµæŸè¨Šæ¯ -->
<div id="game_over_msg"></div>
<!-- Brython éŠæˆ²ç¨‹å¼ -->
<script type="text/python3">
from browser import document, html, timer
import random

# === éŠæˆ²åƒæ•¸ ===
WIDTH, HEIGHT = 400, 400
PLAYER_SIZE = 40
ENEMY_SIZE = 30
STEP = 10

# === éŠæˆ²ç‹€æ…‹ ===
px, py = 180, 180
enemies = []
score = 0
game_over = False
timer_ref = None

player = document["player"]
score_display = document["score_display"]
msg_div = document["game_over_msg"]
game_area = document["game_area"]

# === ç©å®¶ç§»å‹•å‡½å¼ ===
def move_up(ev):
    global py
    py = max(0, py - STEP)
    player.style.top = f"{py}px"

def move_down(ev):
    global py
    py = min(HEIGHT-PLAYER_SIZE, py + STEP)
    player.style.top = f"{py}px"

def move_left(ev):
    global px
    px = max(0, px - STEP)
    player.style.left = f"{px}px"

def move_right(ev):
    global px
    px = min(WIDTH-PLAYER_SIZE, px + STEP)
    player.style.left = f"{px}px"

document["btn_up"].bind("click", move_up)
document["btn_down"].bind("click", move_down)
document["btn_left"].bind("click", move_left)
document["btn_right"].bind("click", move_right)

# === æ•µäººç”Ÿæˆ ===
def spawn_enemy(ev=None):
    ex = random.randint(0, WIDTH - ENEMY_SIZE)
    ey = random.randint(0, HEIGHT - ENEMY_SIZE)
    enemy = html.DIV(style=f"width:{ENEMY_SIZE}px;height:{ENEMY_SIZE}px;background:red;position:absolute;left:{ex}px;top:{ey}px;")
    game_area <= enemy
    enemies.append({"el": enemy, "dx": random.choice([-3,3]), "dy": random.choice([-3,3])})

document["btn_spawn"].bind("click", spawn_enemy)

# === ç©å®¶é¡è‰²è®Šæ› ===
def change_color(ev):
    colors = ["blue", "green", "purple", "orange", "pink"]
    player.style.backgroundColor = random.choice(colors)

document["btn_color"].bind("click", change_color)

# === éŠæˆ²é‡æ–°é–‹å§‹ ===
def restart_game(ev):
    global score, game_over, px, py, enemies, timer_ref
    for e in enemies: e["el"].remove()
    enemies.clear()
    msg_div.text = ""
    px, py = WIDTH//2 - PLAYER_SIZE//2, HEIGHT//2 - PLAYER_SIZE//2
    player.style.left = f"{px}px"
    player.style.top = f"{py}px"
    score = 0
    score_display.text = f"åˆ†æ•¸: {score}"
    game_over = False
    timer_ref = timer.set_interval(game_loop, 100)

document["btn_restart"].bind("click", restart_game)

# === ç¢°æ’æª¢æ¸¬ ===
def check_collision(px, py, ex, ey):
    return (px < ex+ENEMY_SIZE and px+PLAYER_SIZE > ex and
            py < ey+ENEMY_SIZE and py+PLAYER_SIZE > ey)

# === æ•µäººç§»å‹• ===
def update_enemies():
    global game_over, timer_ref
    if game_over: return
    for e in enemies:
        left = int(e["el"].style.left[:-2]) + e["dx"]
        top = int(e["el"].style.top[:-2]) + e["dy"]
        if left <=0 or left >= WIDTH-ENEMY_SIZE: e["dx"] *= -1
        if top <=0 or top >= HEIGHT-ENEMY_SIZE: e["dy"] *= -1
        e["el"].style.left = f"{left}px"
        e["el"].style.top = f"{top}px"
        if check_collision(px, py, left, top):
            msg_div.text = "ğŸ’€ éŠæˆ²çµæŸ ğŸ’€"
            msg_div.style = "color:red;font-size:24px;font-weight:bold;"
            timer.clear_interval(timer_ref)
            game_over = True
            return

# === è¨ˆåˆ†æ›´æ–° ===
def update_score():
    global score
    if game_over: return
    score += 1
    score_display.text = f"åˆ†æ•¸: {score}"

# === éŠæˆ²è¿´åœˆ ===
def game_loop():
    update_enemies()
    update_score()

timer_ref = timer.set_interval(game_loop, 100)
</script><h1>â›§</h1>
<!-- å°å…¥ Brython -->
<script src="/static/brython.js"></script>
<script src="/static/brython_stdlib.js"></script>
<script>
window.onload = function() {
    console.log("å•Ÿå‹• Brython...");
    brython({debug:1, pythonpath:['/static/', './../downloads/py/']});
}
</script>
<!-- éŠæˆ²é¡¯ç¤ºå€ -->
<div id="brython_div1" style="width: 800px; height: 800px; border: 2px solid black; position: relative; margin: 10px; overflow: hidden;"></div>
<!-- æŒ‰éˆ• -->
<p style="text-align: center; margin-top: 10px;"><button id="moveButton">â›§</button></p>
<script type="text/python3">
from browser import document, html, timer
import random, math

CELL_SIZE = 60
IMG_PATH = "https://mde.tw/cp2025/reeborg/src/images/"

div = document['brython_div1']
div.style.backgroundColor = "midnightblue"

# === é–ƒçˆæ˜Ÿæ˜Ÿ ===
letters = []
def create_h_line(count):
    container = html.DIV()
    container.style.display = "flex"
    container.style.justifyContent = "space-between"
    container.style.position = "absolute"
    container.style.bottom = "10px"
    container.style.left = "10px"
    for _ in range(count):
        span = html.SPAN("æ˜Ÿæ˜Ÿ")
        span.style.fontWeight = "bold"
        span.style.color = random.choice(["red","green","blue","orange","purple"])
        span.style.fontSize = f"{random.randint(28,50)}px"
        container <= span
        letters.append(span)
    div <= container

create_h_line(40)

def flicker():
    for span in letters:
        span.style.color = random.choice(["yellow","white","lightblue","lightyellow"])
        span.style.fontSize = f"{random.randint(28,50)}px"
    timer.set_timeout(flicker, 300)

flicker()

# === é–ƒçˆå°åœ“é» ===
dots = []

def create_flickering_dots(count):
    for _ in range(count):
        dot = html.DIV()
        dot.style.width = f"{random.randint(3,8)}px"
        dot.style.height = dot.style.width
        dot.style.borderRadius = "50%"
        dot.style.backgroundColor = "white"
        dot.style.position = "absolute"
        dot.style.left = f"{random.randint(0, 700)}px"
        dot.style.top = f"{random.randint(0, 600)}px"
        div <= dot
        dots.append(dot)

create_flickering_dots(30)

def update_dots():
    for dot in dots:
        dot.style.left = f"{random.randint(0,700)}px"
        dot.style.top = f"{random.randint(0,600)}px"

# === ä¸–ç•Œèˆ‡æ©Ÿå™¨äºº ===
class World:
    def __init__(self, width, height):
        self.width = width
        self.height = height
        self.layers = {
            "objects": html.CANVAS(width=width*CELL_SIZE, height=height*CELL_SIZE),
            "robots": html.CANVAS(width=width*CELL_SIZE, height=height*CELL_SIZE)
        }
        container = html.DIV(style={"position":"relative","width":f"{width*CELL_SIZE}px","height":f"{height*CELL_SIZE}px"})
        for canvas in self.layers.values():
            canvas.style = {"position":"absolute","top":"0px","left":"0px"}
            container <= canvas
        div <= container

    def _draw_image(self, ctx, src, x, y):
        img = html.IMG()
        img.src = src
        def onload(evt):
            px = x*CELL_SIZE
            py = (self.height-1-y)*CELL_SIZE
            ctx.drawImage(img, px, py, CELL_SIZE, CELL_SIZE)
        img.bind("load", onload)

class AnimatedRobot:
    def __init__(self, world, x, y):
        self.world = world
        self.x = x-1
        self.y = y-1
        self.robot_ctx = world.layers["robots"].getContext("2d")
        self.trace_ctx = world.layers["objects"].getContext("2d")
        self.queue = []
        self.running = False
        self._draw_robot()

    def _draw_robot(self):
        self.robot_ctx.clearRect(0,0,self.world.width*CELL_SIZE,self.world.height*CELL_SIZE)
        self.world._draw_image(self.robot_ctx, IMG_PATH + "blue_robot_e.png", self.x, self.y)

    def mark(self, x, y):
        ctx = self.trace_ctx
        ctx.fillStyle = "yellow"
        px = x * CELL_SIZE
        py = (self.world.height-1-y) * CELL_SIZE
        ctx.fillRect(px+CELL_SIZE*0.2, py+CELL_SIZE*0.2, CELL_SIZE*0.6, CELL_SIZE*0.6)

    def move_to(self, x, y, mark=False):
        def action(done):
            self.x, self.y = x, y
            if mark:
                self.mark(x, y)
            self._draw_robot()
            timer.set_timeout(done, 300)
        self.queue.append(action)
        self._run_queue()

    def _run_queue(self):
        if self.running or not self.queue: return
        self.running = True
        action = self.queue.pop(0)
        action(lambda: self._done())

    def _done(self):
        self.running = False
        self._run_queue()

# åˆå§‹åŒ–ä¸–ç•Œ
world = World(12,12)
robot = AnimatedRobot(world,6,6)

# äº”è§’æ˜Ÿåº§æ¨™
def calculate_star_points(center_x, center_y, outer_radius, inner_radius):
    points = []
    for i in range(5):
        angle = math.radians(i*72)
        outer_x = center_x + outer_radius*math.cos(angle)
        outer_y = center_y + outer_radius*math.sin(angle)
        points.append((outer_x, outer_y))
        inner_angle = math.radians(i*72+36)
        inner_x = center_x + inner_radius*math.cos(inner_angle)
        inner_y = center_y + inner_radius*math.sin(inner_angle)
        points.append((inner_x, inner_y))
    return points

star_points = calculate_star_points(6,6,4,2)

def draw_star_path():
    for i in range(5):
        x1,y1 = star_points[i*2]
        x2,y2 = star_points[i*2+1]
        robot.move_to(x1,y1,mark=True)
        robot.move_to(x2,y2,mark=True)
    robot.move_to(star_points[0][0], star_points[0][1], mark=True)

draw_star_path()

# æŒ‰éˆ•äº‹ä»¶ï¼Œå¢åŠ  debug log
def on_button_click(ev):
    print("â›§ æŒ‰éˆ•è¢«é»æ“Š")
    update_dots()
    draw_star_path()

document["moveButton"].bind("click", on_button_click)
</script><h1>Brython</h1>
<p><a href="https://brython.info/">Brython</a> æ˜¯ä¸€å€‹å°‡ <a href="https://en.wikipedia.org/wiki/Python_(programming_language)">Python</a> èªæ³•ç·¨è­¯ç‚º <a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript">JavaScript</a> çš„å·¥å…·ï¼Œèƒ½ç›´æ¥åœ¨ç€è¦½å™¨ä¸­ä»¥ <a href="https://en.wikipedia.org/wiki/Python_(programming_language)">Python</a> æ’°å¯«å‰ç«¯ç¶²é ç¨‹å¼ã€‚</p>
<p><button id="add1to100">1 add to 100</button><button id="robot1">æ©Ÿå™¨äººå·¡é‚</button><button id="free_walk">è‡ªç”±è¡Œ</button></p>
<!-- å°å…¥ brython ç¨‹å¼åº« -->
<p>
<script src="/static/brython.js"></script>
<script src="/static/brython_stdlib.js"></script>
</p>
<!-- å•Ÿå‹• Brython -->
<p>
<script>
window.onload=function(){
brython({debug:1, pythonpath:['/static/','./../downloads/py/']});
}
</script>
</p>
<p><!-- å°å…¥ FileSaver èˆ‡ filereader --></p>
<p>
<script src="/static/ace/FileSaver.min.js" type="text/javascript"></script>
<script src="/static/ace/filereader.js" type="text/javascript"></script>
</p>
<p><!-- å°å…¥ ace --></p>
<p>
<script src="/static/ace/ace.js" type="text/javascript"></script>
<script src="/static/ace/ext-language_tools.js" type="text/javascript"></script>
<script src="/static/ace/mode-python3.js" type="text/javascript"></script>
<script src="/static/ace/snippets/python.js" type="text/javascript"></script>
</p>
<p><!-- å°å…¥ gearUtils-0.9.js Cango é½’è¼ªç¹ªåœ–ç¨‹å¼åº« -->
<script src="/static/Cango-24v03-min.js"></script>
<script src="/static/gearUtils-09.js"></script>
<script src="/static/SVGpathUtils-6v03-min.js"></script>
<script src="/static/sylvester.js"></script>
<script src="/static/PrairieDraw.js"></script>
</p>
<p><!-- è«‹æ³¨æ„, é€™è£¡ä½¿ç”¨ Javascript å°‡ localStorage["kw_py_src1"] ä¸­å­˜åœ¨è¿‘ç«¯ç€è¦½å™¨çš„ç¨‹å¼ç¢¼, ç”±ä½¿ç”¨è€…æ±ºå®šå­˜æª”åç¨±--></p>
<p>
<script type="text/javascript">
function doSave(storage_id, filename){
    var blob = new Blob([localStorage[storage_id]], {type: "text/plain;charset=utf-8"});
    filename = document.getElementById(filename).value
    saveAs(blob, filename+".py");
}
</script>
</p>
<p><!-- ç´¯åŠ ç¨‹å¼é–‹å§‹ -->
<script type="text/python3">
from browser import document as doc
import ace
# æ¸…é™¤ç•«å¸ƒ
def clear_bd1(ev):
    bd = doc["brython_div1"]
    bd.clear()
Ace1 = ace.Editor(editor_id="kw_editor1", console_id="kw_console1", container_id="kw__container1", storage_id="kw_py_src1" )
# å¾ gist å–å‡ºç¨‹å¼ç¢¼å¾Œ, æ”¾å…¥ editor ä½œç‚º default ç¨‹å¼
def run1():
    # åˆ©ç”¨ get å–ä¸‹ src è®Šæ•¸å€¼
    try:
        url = doc.query["src"]
    except:
        url = "https://gist.githubusercontent.com/mdecourse/0229a8a017091476a79700b8a190f185/raw/c3a6deaf717f8f2739a4b1392a5ab10936e9693a/from_1_add_to_10_1.py"
    prog = open(url).read()

    # å°‡ç¨‹å¼è¼‰å…¥ç·¨è¼¯å€
    Ace1.editor.setValue(prog)
    Ace1.editor.scrollToRow(0)
    Ace1.editor.gotoLine(0)
    # ç›´æ¥åŸ·è¡Œç¨‹å¼
    #ns = {'__name__':'__main__'}
    #exec(prog, ns)
    # æŒ‰ä¸‹ run æŒ‰éˆ•
    Ace1.run()
# åŸ·è¡Œç¨‹å¼, é¡¯ç¤ºè¼¸å‡ºçµæœèˆ‡æ¸…é™¤è¼¸å‡ºçµæœåŠå°æ‡‰æŒ‰éˆ•ç¶å®š
doc['kw_run1'].bind('click', Ace1.run)
doc['kw_show_console1'].bind('click', Ace1.show_console)
doc['kw_clear_console1'].bind('click', Ace1.clear_console)
doc['clear_bd1'].bind('click', clear_bd1)
# å‘¼å«å‡½å¼åŸ·è¡Œ
run1()
</script>
<!-- ç´¯åŠ ç¨‹å¼çµæŸ --> <!-- æ©Ÿå™¨äººå·¡é‚ç¨‹å¼é–‹å§‹ -->
<script type="text/python3">
from browser import document as doc
import ace

# æ¸…é™¤ç•«å¸ƒ
def clear_bd1(ev):
    bd = doc["brython_div1"]
    bd.clear()

# åˆ©ç”¨ ace ä¸­çš„ Editor å»ºç«‹ Ace2 ç‰©ä»¶, å…¶ä¸­çš„è¼¸å…¥è®Šæ•¸åˆ†åˆ¥å°æ‡‰åˆ°é é¢ä¸­çš„ç·¨è¼¯å€ç‰©ä»¶
Ace2 = ace.Editor(editor_id="kw_editor1", console_id="kw_console1", container_id="kw__container1", storage_id="kw_py_src1" )

robot1_url = "https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/b33c5fc2a0774f8c5d2b0e8c7c7908e58d73bb94/robot_1.py"

# å¾ gist å–å¾—ç¨‹å¼ç¢¼
robot1_src = open(robot1_url).read()
def robot1(ev):
    Ace2.editor.setValue(robot1_src)
    Ace2.editor.scrollToRow(0)
    Ace2.editor.gotoLine(0)
    Ace2.run()

# id ç‚º "robot1" çš„æŒ‰éˆ•é»æŒ‰æ™‚, åŸ·è¡Œ robot1 æ–¹æ³•
doc["robot1"].bind('click', robot1)
</script>
<!-- æ©Ÿå™¨äººå·¡é‚ç¨‹å¼çµæŸ --></p>
<!-- æ©Ÿå™¨äººè‡ªç”±è¡Œç¨‹å¼é–‹å§‹ -->
<p>
<script type="text/python3">
from browser import document as doc
import ace

# æ¸…é™¤ç•«å¸ƒ
def clear_bd1(ev):
    bd = doc["brython_div1"]
    bd.clear()

# åˆ©ç”¨ ace ä¸­çš„ Editor å»ºç«‹ Ace2 ç‰©ä»¶, å…¶ä¸­çš„è¼¸å…¥è®Šæ•¸åˆ†åˆ¥å°æ‡‰åˆ°é é¢ä¸­çš„ç·¨è¼¯å€ç‰©ä»¶
Ace2 = ace.Editor(editor_id="kw_editor1", console_id="kw_console1", container_id="kw__container1", storage_id="kw_py_src1" )

free_walk_url = "https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/9d55811467e411eb89f74171d8a586ae9f1a96aa/brython_robot_free_walk.py"

# å¾ gist å–å¾—ç¨‹å¼ç¢¼
free_walk_src = open(free_walk_url).read()
def free_walk(ev):
    Ace2.editor.setValue(free_walk_src)
    Ace2.editor.scrollToRow(0)
    Ace2.editor.gotoLine(0)
    Ace2.run()

# id ç‚º "free_walk" çš„æŒ‰éˆ•é»æŒ‰æ™‚, åŸ·è¡Œ robot1 æ–¹æ³•
doc["free_walk"].bind('click', free_walk)
</script>
</p>
<!-- æ©Ÿå™¨äººè‡ªç”±è¡Œç¨‹å¼çµæŸ -->
<p><!-- add 1 to 100 é–‹å§‹ -->
<script type="text/python3">
from browser import document as doc
import ace

# æ¸…é™¤ç•«å¸ƒ
def clear_bd1(ev):
    bd = doc["brython_div1"]
    bd.clear()

# åˆ©ç”¨ ace ä¸­çš„ Editor å»ºç«‹ Ace2 ç‰©ä»¶, å…¶ä¸­çš„è¼¸å…¥è®Šæ•¸åˆ†åˆ¥å°æ‡‰åˆ°é é¢ä¸­çš„ç·¨è¼¯å€ç‰©ä»¶
Ace2 = ace.Editor(editor_id="kw_editor1", console_id="kw_console1", container_id="kw__container1", storage_id="kw_py_src1" )

add1to100_url = "https://gist.githubusercontent.com/mdecourse/0229a8a017091476a79700b8a190f185/raw/c48e37714f055c3a0027cbfef59e442a6ef659b9/from_1_add_to_100_1.py"

# å¾ gist å–å¾—ç¨‹å¼ç¢¼
add_src = open(add1to100_url).read()
def add(ev):
    Ace2.editor.setValue(add_src)
    Ace2.editor.scrollToRow(0)
    Ace2.editor.gotoLine(0)
    Ace2.run()

# id ç‚º "add1to100" çš„æŒ‰éˆ•é»æŒ‰æ™‚, åŸ·è¡Œ add æ–¹æ³•
doc["add1to100"].bind('click', add)
</script>
</p>
<p><!-- add 1 to 100 çµæŸ--></p>
<!-- editor1 é–‹å§‹ -->
<p><!-- ç”¨ä¾†é¡¯ç¤ºç¨‹å¼ç¢¼çš„ editor å€åŸŸ --></p>
<div id="kw_editor1" style="width: 600px; height: 300px;"></div>
<p><!-- ä»¥ä¸‹çš„è¡¨å–®èˆ‡æŒ‰éˆ•èˆ‡å‰é¢çš„ Javascript doSave å‡½å¼ä»¥åŠ FileSaver.min.js äº’ç›¸é…åˆ --></p>
<p><!-- å­˜æ“‹è¡¨å–®é–‹å§‹ --></p>
<form><label>Filename: <input id="kw_filename" placeholder="input file name" type="text"/>.py</label> <input onclick="doSave('kw_py_src1', 'kw_filename1');" type="submit" value="Save"/></form>
<p><!-- å­˜æ“‹è¡¨å–®çµæŸ --></p>
<p></p>
<p><!-- åŸ·è¡Œèˆ‡æ¸…é™¤æŒ‰éˆ•é–‹å§‹ --></p>
<p><button id="kw_run1">Run</button> <button id="kw_show_console1">Output</button> <button id="kw_clear_console1">æ¸…é™¤è¼¸å‡ºå€</button><button id="clear_bd1">æ¸…é™¤ç¹ªåœ–å€</button><button onclick="window.location.reload()">Reload</button></p>
<p><!-- åŸ·è¡Œèˆ‡æ¸…é™¤æŒ‰éˆ•çµæŸ --></p>
<p></p>
<p><!-- ç¨‹å¼åŸ·è¡Œ ouput å€ --></p>
<div style="width: 100%; height: 100%;"><textarea autocomplete="off" id="kw_console1"></textarea></div>
<p><!-- Brython ç¨‹å¼åŸ·è¡Œçš„çµæœ, éƒ½ä»¥ brython_div1 ä½œç‚ºåˆ‡å…¥ä½ç½® --></p>
<div id="brython_div1"></div>
<!-- editor1 çµæŸ --><hr/><!-- ########################################## -->
<p>å¾ 1 ç´¯åŠ åˆ° 100 part2:</p>
<p><button id="add1to100part2">1 add to 100</button><button id="cango_three_gears">cango_three_gears</button><button id="bsnake">BSnake</button><button id="aitetris">AI Tetris</button></p>
<p><!-- è«‹æ³¨æ„, é€™è£¡ä½¿ç”¨ Javascript å°‡ localStorage["kw_py_src2"] ä¸­å­˜åœ¨è¿‘ç«¯ç€è¦½å™¨çš„ç¨‹å¼ç¢¼, ç”±ä½¿ç”¨è€…æ±ºå®šå­˜æª”åç¨±--></p>
<p>
<script type="text/python3">
from browser import document as doc
import ace
# æ¸…é™¤ç•«å¸ƒ
def clear_bd2(ev):
    bd = doc["brython_div2"]
    bd.clear()
Ace3 = ace.Editor(editor_id="kw_editor2", console_id="kw_console2", container_id="kw__container2", storage_id="kw_py_src2" )
# å¾ gist å–å‡ºç¨‹å¼ç¢¼å¾Œ, æ”¾å…¥ editor ä½œç‚º default ç¨‹å¼
def run2():
    # åˆ©ç”¨ get å–ä¸‹ src è®Šæ•¸å€¼
    try:
        url = doc.query["src2"]
    except:
        url = "https://gist.githubusercontent.com/mdecourse/0229a8a017091476a79700b8a190f185/raw/c3a6deaf717f8f2739a4b1392a5ab10936e9693a/from_1_add_to_10_1.py"
    prog = open(url).read()

    # å°‡ç¨‹å¼è¼‰å…¥ç·¨è¼¯å€
    Ace3.editor.setValue(prog)
    Ace3.editor.scrollToRow(0)
    Ace3.editor.gotoLine(0)
    # ç›´æ¥åŸ·è¡Œç¨‹å¼
    #ns = {'__name__':'__main__'}
    #exec(prog, ns)
    # æŒ‰ä¸‹ run æŒ‰éˆ•
    Ace3.run()

# åŸ·è¡Œç¨‹å¼, é¡¯ç¤ºè¼¸å‡ºçµæœèˆ‡æ¸…é™¤è¼¸å‡ºçµæœåŠå°æ‡‰æŒ‰éˆ•ç¶å®š
doc['kw_run2'].bind('click', Ace3.run)
doc['kw_show_console2'].bind('click', Ace3.show_console)
doc['kw_clear_console2'].bind('click', Ace3.clear_console)
doc['clear_bd2'].bind('click', clear_bd2)
# å‘¼å«å‡½å¼åŸ·è¡Œ
run2()
</script>
</p>
<p><!-- add 1 to 100 part2 é–‹å§‹ -->
<script type="text/python3">
from browser import document as doc
import ace

# æ¸…é™¤ç•«å¸ƒ
def clear_bd2(ev):
    bd = doc["brython_div2"]
    bd.clear()

# åˆ©ç”¨ ace ä¸­çš„ Editor å»ºç«‹ Ace2 ç‰©ä»¶, å…¶ä¸­çš„è¼¸å…¥è®Šæ•¸åˆ†åˆ¥å°æ‡‰åˆ°é é¢ä¸­çš„ç·¨è¼¯å€ç‰©ä»¶
Ace4 = ace.Editor(editor_id="kw_editor2", console_id="kw_console2", container_id="kw__container2", storage_id="kw_py_src2" )

# é€é Ace4 ä»¥é¡åˆ¥å»ºç«‹ä¸€å€‹é€šç”¨çš„ button2, å¯ä»¥åœ¨å¤šå€‹æ¡ˆä¾‹ä¸­å°‡ gist ç¨‹å°å…¥ç·¨è¼¯å€

class button2:
    def __init__(self, url):
        self.url = url

    # è¨˜å¾—åŠ å…¥ event è¼¸å…¥è®Šæ•¸
    def do(self,ev):
        Ace4.editor.setValue(open(self.url).read())
        Ace4.editor.scrollToRow(0)
        Ace4.editor.gotoLine(0)
        Ace4.run()

add1to100_url = "https://gist.githubusercontent.com/mdecourse/0229a8a017091476a79700b8a190f185/raw/c48e37714f055c3a0027cbfef59e442a6ef659b9/from_1_add_to_100_1.py"

# å¾ gist å–å¾—ç¨‹å¼ç¢¼
add_src = open(add1to100_url).read()
def add2(ev):
    Ace4.editor.setValue(add_src)
    Ace4.editor.scrollToRow(0)
    Ace4.editor.gotoLine(0)
    Ace4.run()

# id ç‚º "add1to100part2" çš„æŒ‰éˆ•é»æŒ‰æ™‚, åŸ·è¡Œ add æ–¹æ³•
doc["add1to100part2"].bind('click', add2)
# ä»¥ä¸‹ç‚ºé‹ç”¨ button2 class çš„é€šç”¨ gist ç¨‹å¼å°å…¥å€
################################## cango_three_gears start
cango_three_gears_url = "https://gist.githubusercontent.com/mdecycu/d9082d678096bd58378d6afe2c7fa05d/raw/f7a85d737d6723d5e34c526d5daee990ed92c32b/cango_three_gears_brython_div2.py"
cango_three_gears = button2(cango_three_gears_url)
doc["cango_three_gears"].bind("click", cango_three_gears.do)
################################## cango_three_gears end
################################## bsnake start
bsnake_url = "https://gist.githubusercontent.com/mdecycu/d9082d678096bd58378d6afe2c7fa05d/raw/f7a85d737d6723d5e34c526d5daee990ed92c32b/kmol_snakey.py"
bsnake = button2(bsnake_url)
doc["bsnake"].bind("click", bsnake.do)
################################## bsnake end
################################## aitetris start
aitetris_url = "https://gist.githubusercontent.com/mdecycu/d9082d678096bd58378d6afe2c7fa05d/raw/f7a85d737d6723d5e34c526d5daee990ed92c32b/pygame_to_brython_tetris_ai.py"
aitetris = button2(aitetris_url)
doc["aitetris"].bind("click", aitetris.do)
################################## aitetris end
</script>
</p>
<p><!-- add 1 to 100 part2 çµæŸ--></p>
<!-- editor2 é–‹å§‹ -->
<p><!-- ç”¨ä¾†é¡¯ç¤ºç¨‹å¼ç¢¼çš„ editor å€åŸŸ --></p>
<div id="kw_editor2" style="width: 600px; height: 300px;"></div>
<p><!-- ä»¥ä¸‹çš„è¡¨å–®èˆ‡æŒ‰éˆ•èˆ‡å‰é¢çš„ Javascript doSave å‡½å¼ä»¥åŠ FileSaver.min.js äº’ç›¸é…åˆ --></p>
<p><!-- å­˜æ“‹è¡¨å–®é–‹å§‹ --></p>
<form><label>Filename: <input id="kw_filename2" placeholder="input file name" type="text"/>.py</label> <input onclick="doSave('kw_py_src2', 'kw_filename2');" type="submit" value="Save"/></form>
<p><!-- å­˜æ“‹è¡¨å–®çµæŸ --></p>
<p></p>
<p><!-- åŸ·è¡Œèˆ‡æ¸…é™¤æŒ‰éˆ•é–‹å§‹ --></p>
<p><button id="kw_run2">Run</button> <button id="kw_show_console2">Output</button> <button id="kw_clear_console2">æ¸…é™¤è¼¸å‡ºå€</button><button id="clear_bd2">æ¸…é™¤ç¹ªåœ–å€</button><button onclick="window.location.reload()">Reload</button></p>
<p><!-- åŸ·è¡Œèˆ‡æ¸…é™¤æŒ‰éˆ•çµæŸ --></p>
<p></p>
<p><!-- ç¨‹å¼åŸ·è¡Œ ouput å€ --></p>
<div style="width: 100%; height: 100%;"><textarea autocomplete="off" id="kw_console2"></textarea></div>
<p><!-- Brython ç¨‹å¼åŸ·è¡Œçš„çµæœ, éƒ½ä»¥ brython_div1 ä½œç‚ºåˆ‡å…¥ä½ç½® --></p>
<div id="brython_div2"></div>
<!-- editor2 çµæŸ --><hr/>
<p></p><h2>Pyodide3</h2>
<p>Pyodide3 å‰‡åœ¨ <a href="https://mde.tw/cp2025/content/Pyodide.html">Pyodide</a> èˆ‡ <a href="https://mde.tw/cp2025/content/Pyodide2.html">Pyodide2</a> é é¢æ¶æ§‹ä¸‹ï¼Œé€²ä¸€æ­¥å°å…¥ <a href="https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/9f43571ec070ea3e24b083525ee27275a96efcc8/robot_w_world.py">robot_w_world.py</a>ï¼Œåœ¨æ—¢æœ‰çš„æ°´å¹³åœç‰† <a href="https://mde.tw/cp2025/reeborg/src/images/north.png">north.png</a> èˆ‡å‚ç›´åœç‰† <a href="https://mde.tw/cp2025/reeborg/src/images/east.png">east.png</a> æª”æ¡ˆä¹‹å¤–ï¼ŒåŠ å…¥ <a href="https://mde.tw/cp2025/reeborg/src/images/carrot.png">carrot.png</a>ã€<a href="https://mde.tw/cp2025/reeborg/src/images/grass.png">grass.png</a> èˆ‡ <a href="https://mde.tw/cp2025/reeborg/src/images/pale_grass.png">pale_grass.png</a> ç­‰åœ–æª”ã€‚ä¸¦ä¸”æ“´å……å¯å¾ URL è®€é€² json æ ¼å¼çš„ world è®Šæ•¸åŠŸèƒ½ï¼Œä»¥ä¾¿è£½ä½œå‡ºæ›´å¤šå…ƒçš„å ´æ™¯ä»»å‹™ï¼Œè¦æ±‚æ©Ÿå™¨äººåŸ·è¡Œã€‚</p>
<p>å…¶ä¸­ src URL è®Šæ•¸ï¼Œå¯ä»¥å°‡ç¶²è·¯ä¸Šçš„æ©Ÿå™¨äººæ§åˆ¶ç¨‹å¼å°å…¥ Pyodide3 é é¢å¤–ï¼Œworld URL è®Šæ•¸å‰‡å¯ä»¥å°å…¥æºè‡ª <a href="https://mde.tw/reeborg">Reeborg</a> æ©Ÿå™¨äººç¨‹å¼æ‰€è¨­å®šçš„ json æ ¼å¼å ´æ™¯ã€‚</p>
<p>ç”±æ–¼ Reeborg ç³»çµ±ä¸­çš„ png åœ–æª”å‡éé€æ˜èƒŒæ™¯ï¼Œ<a href="https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/9f43571ec070ea3e24b083525ee27275a96efcc8/robot_w_world.py">robot_w_world.py</a>Â å¿…é ˆåˆ©ç”¨ HTML ä¸­çš„ CANVASï¼Œå°‡é—œéµçš„ç™½è‰²èƒŒæ™¯ï¼Œä»¥é€æ˜çš„æ–¹å¼é¡¯ç¤ºã€‚</p>
<p>src URL è®Šæ•¸è®€é€² <a href="https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/8ac3ce859d6aec327b7859e091168270d6a951f7/pyodide2_turn_right.py">turn_right ç¨‹å¼</a>ï¼Œè€Œ world URL è®Šæ•¸å‰‡è®€é€² <a href="https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/43517f3f54a5ac24d55d5a5cf8d316e6db2f3b65/harvest2.json">harvest2.json</a>ï¼ŒåŸ·è¡Œ<a href="https://mde.tw/cp2025/content/Pyodide3.html?src=https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/8ac3ce859d6aec327b7859e091168270d6a951f7/pyodide2_turn_right.py&amp;world=https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/43517f3f54a5ac24d55d5a5cf8d316e6db2f3b65/harvest2.json">çµæœ</a>ã€‚</p>
<p>è®€é€² <a href="https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/1b1c26eca7f5d772c6301bae865efaddb00a87bb/harvest3.json">harvest3.json</a>, åŸ·è¡Œ<a href="https://mde.tw/cp2025/content/Pyodide3.html?src=https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/8ac3ce859d6aec327b7859e091168270d6a951f7/pyodide2_turn_right.py&amp;world=https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/9f43571ec070ea3e24b083525ee27275a96efcc8/harvest3.json">çµæœ</a>ã€‚</p>
<p>
<script src="https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js"></script>
</p>
<p><button id="version">version</button> <button id="hello_button">hello</button> <button id="add1to100">1 add to 100</button> <button id="robot1">æ©Ÿå™¨äººå·¡é‚</button> <button id="free_walk">è‡ªç”±è¡Œ</button> <button id="numpy_ode">numpy_ode</button></p>
<!-- Ace Editor Scripts -->
<p>
<script src="/static/ace/FileSaver.min.js"></script>
<script src="/static/ace/filereader.js"></script>
<script src="/static/ace/ace.js"></script>
<script src="/static/ace/ext-language_tools.js"></script>
<script src="/static/ace/mode-python.js"></script>
<script src="/static/ace/snippets/python.js"></script>
</p>
<!-- Editor 1 -->
<div id="kw_editor1" style="width: 600px; height: 300px;"></div>
<p><button id="kw_run1">Run</button> <button id="kw_output1">Output</button> <button id="kw_clear_console1">æ¸…é™¤è¼¸å‡ºå€</button> <button onclick="location.reload()">Reload</button></p>
<p><textarea id="kw_console1"></textarea></p>
<div id="pyodide_div1"></div>
<div id="mpl_output1"></div>
<div id="brython_div1"></div>
<hr/>
<p>å¾ 1 ç´¯åŠ åˆ° 100 part2:</p>
<p><button id="add1to100part2">1 add to 100</button></p>
<!-- Editor 2 -->
<div id="kw_editor2" style="width: 600px; height: 300px;"></div>
<p><button id="kw_run2">Run</button> <button id="kw_output2">Output</button> <button id="kw_clear_console2">æ¸…é™¤è¼¸å‡ºå€</button> <button onclick="location.reload()">Reload</button></p>
<p><textarea id="kw_console2"></textarea></p>
<div id="pyodide_div2"></div>
<div id="mpl_output2"></div>
<div id="brython_div2"></div>
<p>
<script>
function getUrlParam(key) {
  return new URLSearchParams(window.location.search).get(key);
}
function updateUrlParam(key, value) {
  const url = new URL(window.location);
  url.searchParams.set(key, value);
  window.history.replaceState({}, "", url);
}

let pyodide, editor1, editor2;

// æ–°å¢ï¼šæŠŠ robot_w_world.py å¯«å…¥ pyodide FS
async function loadRobotModule() {
  const robotUrl = "https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/9f43571ec070ea3e24b083525ee27275a96efcc8/robot_w_world.py";
  const r = await fetch(robotUrl);
  if (!r.ok) throw new Error(`è¼‰å…¥ robot.py å¤±æ•—: ${r.status}`);
  const code = await r.text();
  pyodide.FS.writeFile("/robot.py", code);
  pyodide.runPython(`import sys; sys.path.append("/")`);  // åŠ å…¥æ ¹ç›®éŒ„åˆ° sys.path
}

document.addEventListener("DOMContentLoaded", async () => {
  editor1 = ace.edit("kw_editor1");
  editor1.setTheme("ace/theme/chrome");
  editor1.session.setMode("ace/mode/python");

  editor2 = ace.edit("kw_editor2");
  editor2.setTheme("ace/theme/chrome");
  editor2.session.setMode("ace/mode/python");

  pyodide = await loadPyodide();
  await pyodide.loadPackage(["numpy", "scipy", "matplotlib", "micropip"]);

  // é å…ˆè¼‰å…¥ robot.py
  await loadRobotModule();

  // ä½ ç¾æœ‰çš„ hello() å®šç¾©
  const code = `
def hello():
    print("Hello from custom module!")
`;
  pyodide.runPython(code);

  // é€™æ˜¯ä½ ä¹‹å‰å…¶ä»–æŒ‰éˆ•ç”¨çš„ Gist é€£çµ
  const GIST_ADD1TO100 =
    "https://gist.githubusercontent.com/mdecourse/0229a8a017091476a79700b8a190f185/raw/" +
    "c48e37714f055c3a0027cbfef59e442a6ef659b9/from_1_add_to_100_1.py";
  const NUMPY_ODE =
    "https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/" +
    "98d582539545b3c9fbfa35dd3e605c506367618e/pyodide_ode_ex1.py";
  const PYODIDE_ROBOT_ANIMATION =
    "https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/" +
    "ff833d14181c7e270d37432aa8589f5ecf00e383/pyodide_walk_around2.py";
  const FREE_WALK = 
    "https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/" + "2a66dceb4a1dbdd0c384d4d17453f1e4f03f2493/pyodide_free_walk2.py"

  // é è¨­è¼‰å…¥ GIST_ADD1TO100ï¼ˆæˆ– URL åƒæ•¸æ±ºå®šï¼‰
  const src = getUrlParam("src");
  if (src === PYODIDE_ROBOT_ANIMATION) {
    const robotCode = await fetchCode(PYODIDE_ROBOT_ANIMATION);
    editor1.setValue(robotCode, -1);
    updateUrlParam("src", PYODIDE_ROBOT_ANIMATION);
    runPyodide(editor1, "kw_console1", "brython_div1");
  } else {
    const initialCode = await fetchCode(src || GIST_ADD1TO100);
    editor1.setValue(initialCode, -1);
    runPyodide(editor1, "kw_console1", "brython_div1");
  }

  editor2.setValue("", -1);

  // æŒ‰éˆ•äº‹ä»¶
  document.getElementById("version").onclick = () => {
    const vcode = `
import pyodide
import sys
import matplotlib
import numpy
import scipy
print("Pyodide version:", pyodide.__version__)
print("Python version :", sys.version)
print("matplotlib version:", matplotlib.__version__)
print("numpy version:", numpy.__version__)
print("scipy version:", scipy.__version__)
`;
    editor1.setValue(vcode, -1);
    updateUrlParam("src", "inline_version");
    runPyodide(editor1, "kw_console1", "brython_div1");
  };

  document.getElementById("hello_button").onclick = () => {
    editor1.setValue("hello()", -1);
    updateUrlParam("src", "inline_hello");
    runPyodide(editor1, "kw_console1", "brython_div1");
  };

  document.getElementById("add1to100").onclick = async () => {
    const c = await fetchCode(GIST_ADD1TO100);
    editor1.setValue(c, -1);
    updateUrlParam("src", GIST_ADD1TO100);
    runPyodide(editor1, "kw_console1", "brython_div1");
  };

  document.getElementById("numpy_ode").onclick = async () => {
    const c = await fetchCode(NUMPY_ODE);
    editor1.setValue(c, -1);
    updateUrlParam("src", NUMPY_ODE);
    runPyodide(editor1, "kw_console1", "brython_div1");
  };

  document.getElementById("robot1").onclick = async () => {
    const rc = await fetchCode(PYODIDE_ROBOT_ANIMATION);
    editor1.setValue(rc, -1);
    updateUrlParam("src", PYODIDE_ROBOT_ANIMATION);
    runPyodide(editor1, "kw_console1", "brython_div1");
  };

  document.getElementById("free_walk").onclick = async () => {
    const rc = await fetchCode(FREE_WALK);
    editor1.setValue(rc, -1);
    updateUrlParam("src", FREE_WALK);
    runPyodide(editor1, "kw_console1", "brython_div1");
  };

  document.getElementById("add1to100part2").onclick = async () => {
    const c = await fetchCode(GIST_ADD1TO100);
    editor2.setValue(c, -1);
    runPyodide(editor2, "kw_console2", "brython_div2");
  };

  document.getElementById("kw_run1").onclick = () =>
    runPyodide(editor1, "kw_console1", "brython_div1");
  document.getElementById("kw_run2").onclick = () =>
    runPyodide(editor2, "kw_console2", "brython_div2");
  document.getElementById("kw_clear_console1").onclick = () =>
    clearOutput("kw_console1", "brython_div1");
  document.getElementById("kw_clear_console2").onclick = () =>
    clearOutput("kw_console2", "brython_div2");
});

// èª¿æ•´ output textarea è¡Œæ•¸
document.getElementById("kw_output1").onclick = () => {
  const ta = document.getElementById("kw_console1");
  ta.rows = "15";
  ta.cols = "70";
  ta.scrollTop = 0;
};
document.getElementById("kw_output2").onclick = () => {
  const ta = document.getElementById("kw_console2");
  ta.rows = "15";
  ta.cols = "70";
  ta.scrollTop = 0;
};

async function fetchCode(url) {
  const r = await fetch(url);
  if (!r.ok) throw new Error(`è¼‰å…¥å¤±æ•— ${r.status}`);
  return await r.text();
}

function clearOutput(consoleId, divId) {
  document.getElementById(consoleId).value = "";
  document.getElementById(divId).innerHTML = "";
}

async function runPyodide(editor, consoleId, divId) {
  document.getElementById(consoleId).value = "";
  document.getElementById(divId).innerHTML = "";

  await pyodide.runPythonAsync(`
import sys
class JsWriter:
  def write(self, s):
    from js import document
    ta = document.getElementById("${consoleId}")
    ta.value += s
    ta.scrollTop = ta.scrollHeight
sys.stdout = JsWriter()
sys.stderr = JsWriter()
`);

  try {
    await pyodide.runPythonAsync(editor.getValue());
  } catch (e) {
    document.getElementById(consoleId).value += "\\néŒ¯èª¤ï¼š" + e.toString();
  }
}
</script>
</p>